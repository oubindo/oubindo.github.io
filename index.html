<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="keywords" content="Android">
<meta property="og:type" content="website">
<meta property="og:title" content="Coding and Learning">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Coding and Learning">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Coding and Learning">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Coding and Learning</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Coding and Learning</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">oubindo的技术与生活博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/17/从0到1完成一个健身App/从0到1之一：开篇词与项目总体架构/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="oubindo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding and Learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/17/从0到1完成一个健身App/从0到1之一：开篇词与项目总体架构/" itemprop="url">从零到一完成一个健身App之一：开篇词和项目概述</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-17T10:15:00+08:00">
                2018-09-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/从零到一健身App/" itemprop="url" rel="index">
                    <span itemprop="name">从零到一健身App</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="从零到一完成一个健身App"><a href="#从零到一完成一个健身App" class="headerlink" title="从零到一完成一个健身App"></a>从零到一完成一个健身App</h1><h2 id="一-开篇词"><a href="#一-开篇词" class="headerlink" title="一.开篇词"></a>一.开篇词</h2><p>我的计划是用一年半到两年的时间完成一个健身App。</p>
<p>1.目的：我是一个喜欢接受新技术的人。但是我又是一个很懒的人，这种懒惰体现在自己对于技术可能很多时候只限于使用的地步，而没有去深挖技术内部原理和实现细节，并且对于App的设计也缺乏一定的思考。现在自己已经在公司工作两个月了，从公司的项目中开阔了眼界。但是苦于没有地方练手。所以想找个App把自己学到的应用上来。目前来看，自己对于Android较为深入的技术都缺乏认知，都是需要强补的。这也是我想从头开始设计一个好的应用的原因。</p>
<p>2.项目现状与预期：这个应用是我为自己这种健身爱好者量身打造的应用，也打算部分参考keep和抖音的设计。之前未毕业前就有开始过这个项目的开发，但是当时因为毕业而搁置了。现在再拿出来看，当时的代码写的非常的傻逼。于是打算推翻重来。预期是：</p>
<ul>
<li>学会使用主流框架，如fresco，Architecture Component，RxJava等。</li>
<li>结合组件化和插件化，热修复等技术</li>
<li>对于一些较为简单的工具，如路由框架，能自行编写</li>
<li>关注性能优化</li>
<li>在项目的一些模块中能接触到深度学习。做一个AI赋能的App</li>
</ul>
<p>3.项目计划：因为现在在公司项目中确实压力比较大，10，10，大小周。目前来看，自己能用在这个项目上的时间是早上的八点半到十点。晚上的十点四十到十一点四十。周末也有时间可以搞一搞。考虑到自己可能需要学习很多的知识，而且自己平时的时间也不一定能放到这个上面来，预计需要一年半到两年的时间里完成这个项目。在这两年里，我会每两周根据自己的项目情况完成一篇博客。因为是自己的项目，代码中不会出现公司的代码，所有的代码都是自己学习后产出的。也不希望有人将我这项目用于商业目的。</p>
<p>4.专栏适合的人群：</p>
<ul>
<li>有一定Android开发经验，处于Android基础和进阶之间的人</li>
<li>想通过一个完整项目接触到当前互联网公司里最火热的技术的人</li>
<li>作为Android开发，想接触到深度学习等在Android中应用的人</li>
<li>适用于想一步一步提升自己各方面Android技术的人</li>
</ul>
<h2 id="二。项目概述"><a href="#二。项目概述" class="headerlink" title="二。项目概述"></a>二。项目概述</h2><p>1.项目将会采用的总体架构：</p>
<ul>
<li><p>MVVM和Architecture Component：相信大家都知道有MVC，MVP，和MVVM三种架构，MVC就不说了，MVP在很长的一段时间里都是主流，但是已经体验过MVVM的我不可能再用MVP了-_- 。常用的MVVM框架有databinding，但是databinding会带来业务代码耦合进xml中的问题，扩展性也差。我决定使用google的Architecture Component。谷爹出品，值得信赖，而且还挺好用的，很多数据问题都得到了解决。</p>
</li>
<li><p>RxJava：Rxjava作为一个成熟的库，事件流和函数式编程的思想深入人心</p>
</li>
<li>okhttp+retrofit：这两个框架是当今大厂的主流网络框架，也是学习网络相关的重要入口，我会在基本使用的基础上去挖掘相关的值得学习和有亮点的地方。</li>
<li>fresco：这也是最强大和性能最好的图片框架了。</li>
<li>插件化+组件化+热修复：这三个是类似的，但是又有一些区别。我倾向于每种技术都自己实现一个框架，其中组件化的路由框架我是一定要写的，代码量并不多。其他的就等到时候再看，如果有时间就自己写一个。</li>
<li>AOP技术：主要是用来进行日志和自动埋点等。目前对这块不是特别熟悉，等到时候再考虑吧。</li>
<li>JNA：由于之前没怎么接触过JNI技术，对相关的技术都不是很了解。所以在这个项目中想加入一些特效相关的处理，这也是我的兴趣所在。不可避免的要使用到native方法。因此打算使用JNA这个库</li>
<li>深度学习框架：目前暂定ncnn，腾讯优图出品的开源深度学习框架，看评测是要强于目前所有已知开源框架。</li>
<li>数据库：因为Realm的一些坑，数据库框架打算采用GreenDao。</li>
<li>下载库：打算自己实现一个比较有意思的库。目前公司的项目有，自己可以吸收其精华，去掉自己不需要的部分。</li>
</ul>
<p>再次声明：本项目中不会有公司项目的源码，都是自己完成。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/10/美国大学Online课程推荐及个人评测/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="oubindo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding and Learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/10/美国大学Online课程推荐及个人评测/" itemprop="url">美国大学Online课程及个人评测</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-10T13:28:32+08:00">
                2018-05-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="美国大学Online课程及个人评测"><a href="#美国大学Online课程及个人评测" class="headerlink" title="美国大学Online课程及个人评测"></a>美国大学Online课程及个人评测</h1><h2 id="已刷"><a href="#已刷" class="headerlink" title="已刷"></a>已刷</h2><p>1.Coursera MachineLearning：非常不错的机器学习入门课程，讲解细致，测验和program exercise都是很有效的补充学习资料。</p>
<p>2.Stanford MachineLearning：也是Ng的课程，但是这课程相对上门更难一点，有大量的数学证明，对于想要知根知底的学生来说是一个不错的补充学习资料。我只看了前10个讲座，后面的没看了。</p>
<h2 id="待刷"><a href="#待刷" class="headerlink" title="待刷"></a>待刷</h2><p>1.Coursera Algorithm II：</p>
<p>2.Coursera DeepLearning：</p>
<p>3.<a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-042j-mathematics-for-computer-science-fall-2010/index.htm" target="_blank" rel="noopener">MIT math for computer sciense</a> 这门课大多是离散数学的东西，可以等有空的时候再看，优先级低一些。</p>
<h2 id="外国公开课程地址"><a href="#外国公开课程地址" class="headerlink" title="外国公开课程地址"></a>外国公开课程地址</h2><p>1.<a href="https://ocw.mit.edu/courses/" target="_blank" rel="noopener">MIT open courses</a></p>
<p>2.<a href="https://www.cs.washington.edu/education/courses" target="_blank" rel="noopener">华盛顿大学 open courses </a><br>部分课程有视频在youtube上，很多的课程，几乎涵盖了所有课题。可以作为我以后刷课的主力。</p>
<p>3.直接搜课程英文名，然后看别人的推荐</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/10/kotlin深入学习系列(二)：类与对象篇/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="oubindo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding and Learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/10/kotlin深入学习系列(二)：类与对象篇/" itemprop="url">Kotlin深入学习系列(二):OOP篇</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-10T13:38:32+08:00">
                2018-04-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kotlin/" itemprop="url" rel="index">
                    <span itemprop="name">Kotlin</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="类与对象"><a href="#类与对象" class="headerlink" title="类与对象"></a>类与对象</h1><h2 id="一-类"><a href="#一-类" class="headerlink" title="一.类"></a>一.类</h2><h3 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h3><p>在 Kotlin 中的一个类可以有一个主构造函数和一个或多个次构造函数。主构造函数是类头的一部分：它跟在类名（和可选的类型参数）后。其中由于主构造函数内不能写代码，主要的初始化代码需要在 init{} 中书写。在实例初始化期间，初始化块按照它们出现在类体中的顺序执行，与属性初始化器交织在一起。也就是说这里的<strong>初始化块init其实就是被当成了属性初始化</strong>。主构造函数中的参数默认为类参数使用。</p>
<p>次构造函数可以通过constructor(param)来定义，<strong>所有的构造函数都必须委托给主构造函数，可以直接委托或者通过别的次构造函数简洁委托。</strong> 委托方法是在constructor后面加个this()。</p>
<p>但是这里又有一个坑，次构造函数不能使用val或者var！例子如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class Pair&lt;K, V&gt;(val first: K, val second: V) &#123;</span><br><span class="line"></span><br><span class="line">    init&#123;</span><br><span class="line">        println(<span class="string">"init"</span>)</span><br><span class="line">        println(first)</span><br><span class="line">        println(second)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    constructor(val first: K): <span class="keyword">this</span>(first, <span class="number">0</span>)&#123;    <span class="comment">// 这里的val报错。</span></span><br><span class="line">        println(<span class="string">"constructor"</span>)</span><br><span class="line">        println(first)</span><br><span class="line">        println(second)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>Kotlin所有类都有一个超类Any。声明类时如果使用了open来修饰，那就可以被继承，否则默认不允许继承。</p>
<p>继承的时候如果子类有主构造函数，那么必须用父类的主构造函数参数初始化。否则必须有次构造函数调用super来调用父类的构造函数。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class HeritLearning: ClassLearning&#123;</span><br><span class="line">    constructor(name: String) : <span class="keyword">super</span>(name)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或者</span></span><br><span class="line">class HeritLearning(name: String) : ClassLearning(name)&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如果一个方法同时和多个超类的相同，那就在调用父类方法的时候使用super&lt;父类&gt;.func()来区分父类。</p>
<h3 id="覆盖属性或方法"><a href="#覆盖属性或方法" class="headerlink" title="覆盖属性或方法"></a>覆盖属性或方法</h3><p>开放覆盖的属性和方法必须用open修饰，覆盖的必须用override修饰。覆盖属性的时候var可以覆盖val，反之则不行。</p>
<h3 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h3><p>接口默认为open，不需要主构造函数。</p>
<h2 id="二-字段"><a href="#二-字段" class="headerlink" title="二.字段"></a>二.字段</h2><p>字段的完整语法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var &lt;propertyName&gt;[: &lt;PropertyType&gt;] [= &lt;property_initializer&gt;]</span><br><span class="line">    [&lt;getter&gt;]</span><br><span class="line">    [&lt;setter&gt;]</span><br></pre></td></tr></table></figure></p>
<p>也就是是说，当我们没有声明getter和setter时默认就已经有这些东西了。当我们声明以后可以得到自定义的实现。如果想屏蔽getter或者setter，可以使用private set。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var setterVisibility: String = <span class="string">"abc"</span></span><br><span class="line">    <span class="keyword">private</span> set <span class="comment">// 此 setter 是私有的并且有默认实现</span></span><br></pre></td></tr></table></figure></p>
<p>在访问器里面，我们可以使用field来代替此字段<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var counter = <span class="number">0</span> <span class="comment">// 注意：这个初始器直接为幕后字段赋值</span></span><br><span class="line">    set(value) &#123;</span><br><span class="line">        <span class="keyword">if</span> (value &gt;= <span class="number">0</span>) field = value</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="lateinit"><a href="#lateinit" class="headerlink" title="lateinit"></a>lateinit</h3><p>属性初始化要点如下：</p>
<ul>
<li>当我们在类外面声明属性为可空或非空时，都必须进行初始化</li>
<li>声明为lateinit的对象必须是可空对象，非空对象不行。</li>
<li>使用.isInitialized来判断属性是否被初始化了。</li>
</ul>
<p><img src="http://ovkwd4vse.bkt.clouddn.com/markdown-img-paste-20180410161250423.png" alt=""></p>
<h2 id="三-扩展"><a href="#三-扩展" class="headerlink" title="三.扩展"></a>三.扩展</h2><p>所有扩展的定义域都在包里，使用之外的扩展就需要导入。</p>
<p>1.扩展函数<br>kotlin可以通过扩展来扩展类的新功能而无需继承或装饰。原理就是：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fun ClassLearning.f(str: String)&#123;</span><br><span class="line">    <span class="keyword">this</span>.arr[<span class="number">3</span>] = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">open class <span class="title">ClassLearning</span><span class="params">(val name: String, val age: Int)</span></span>&#123;</span><br><span class="line">    var arr = Array&lt;Int&gt;(<span class="number">5</span>, &#123;<span class="number">1</span>;<span class="number">2</span>;<span class="number">4</span>;<span class="number">2</span>;<span class="number">1</span>&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>反编译之后如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassLearningKt</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">f</span><span class="params">(@NotNull ClassLearning $receiver, @NotNull String str)</span> </span>&#123;</span><br><span class="line">      Intrinsics.checkParameterIsNotNull($receiver, <span class="string">"$receiver"</span>);</span><br><span class="line">      Intrinsics.checkParameterIsNotNull(str, <span class="string">"str"</span>);</span><br><span class="line">      $receiver.getArr()[<span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(@NotNull String[] args)</span> </span>&#123;</span><br><span class="line">      Intrinsics.checkParameterIsNotNull(args, <span class="string">"args"</span>);</span><br><span class="line">      ClassLearning l = <span class="keyword">new</span> ClassLearning(<span class="string">"oubin"</span>);</span><br><span class="line">      f(l, <span class="string">"f方法"</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>可以看到被扩展的对象被打包成了receiver，然后就是这个对象直接操作他自身的元素了。也就是说，扩展对象并没有改变他们所扩展的类，而是通过生成另外一个方法来操作。所以我们可以发现，这个方法绝对是编译器生成的，所以对于运行期重载的情况怕是用不了了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">open class C</span><br><span class="line"></span><br><span class="line">class D: C()</span><br><span class="line"></span><br><span class="line">fun C.foo() = &quot;c&quot;</span><br><span class="line"></span><br><span class="line">fun D.foo() = &quot;d&quot;</span><br><span class="line"></span><br><span class="line">fun printFoo(c: C) &#123;</span><br><span class="line">    println(c.foo())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">printFoo(D())  // 会print c</span><br></pre></td></tr></table></figure></p>
<p>2.扩展属性<br>扩展属性不能有初始化器，他们的行为只能由显式的getter和setter定义。扩展属性也是在新类中生成了一个get方法，然后将扩展属性的get()返回的值进行返回。</p>
<p>3.伴生对象扩展：同样伴生对象也可以定义扩展函数和属性。</p>
<h2 id="四-数据类"><a href="#四-数据类" class="headerlink" title="四.数据类"></a>四.数据类</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data class Person(val name: String)&#123;</span><br><span class="line">    var age: Int = 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun Person.copy(name:String = this.name) = Person(name)</span><br></pre></td></tr></table></figure>
<p>数据类可以将部分属性放入括号内，从而排除这些属性。进行copy的时候可以如上定义，然后Person对象可以直接调用copy函数</p>
<p>数据类的解构声明：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val jane = User(&quot;Jane&quot;, 35)</span><br><span class="line">val (name, age) = jane</span><br><span class="line">println(&quot;$name, $age years of age&quot;)</span><br></pre></td></tr></table></figure></p>
<p>他是使用了利用了componentN()函数。<br><img src="http://ovkwd4vse.bkt.clouddn.com/markdown-img-paste-20180410170358854.png" alt=""></p>
<h2 id="五-嵌套类"><a href="#五-嵌套类" class="headerlink" title="五.嵌套类"></a>五.嵌套类</h2><p>内部类通过标记为inner可以访问外部类的成员，因为会带有一个对外部类的对象的引用。</p>
<p>匿名内部类可以使用对象表达式来实现。</p>
<h2 id="六-对象"><a href="#六-对象" class="headerlink" title="六.对象"></a>六.对象</h2><p>1.对象表达式: 样式为 object: X(){…}<br>当我们不需要任何超类型时，就写做 val a = object{ val x = 3}, 这样我们就可以访问a.x<br>它的实现原理是通过new Object()去生成了这样一个对象并定义相关属性。</p>
<p>对象表达式可以访问外部的属性，并且比java匿名内部类更牛的是它不限制是final对象。</p>
<p>2.伴生对象<br>当我们在类中定义伴生对象时发生了什么：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">class HeritLearning(name: String) : ClassLearning(name)&#123;</span><br><span class="line">    companion object &#123;</span><br><span class="line">        val x: String = <span class="string">"ds"</span></span><br><span class="line"></span><br><span class="line">        <span class="function">fun <span class="title">get</span><span class="params">()</span></span>&#123;</span><br><span class="line">            println()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 反编译后为</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Companion</span> </span>&#123;</span><br><span class="line">      <span class="meta">@NotNull</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">getX</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> HeritLearning.x;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         System.out.println();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">private</span> <span class="title">Companion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// $FF: synthetic method</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="title">Companion</span><span class="params">(DefaultConstructorMarker $constructor_marker)</span> </span>&#123;</span><br><span class="line">         <span class="keyword">this</span>();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>可以看到我们的companion被编译成了一个静态内部类，属性被定义为外部类的静态属性，而方法确是这个静态内部类的方法。由此，我们知道伴生方法是访问不了非伴生属性的。</p>
<h2 id="七-委托"><a href="#七-委托" class="headerlink" title="七.委托"></a>七.委托</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Base</span> </span>&#123;</span><br><span class="line">    <span class="function">fun <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">class <span class="title">BaseImpl</span><span class="params">(val x: Int)</span> : Base </span>&#123;</span><br><span class="line">    <span class="function">override fun <span class="title">print</span><span class="params">()</span> </span>&#123; print(x) &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Derived(b: Base) : Base by b</span><br><span class="line"></span><br><span class="line"><span class="function">fun <span class="title">main</span><span class="params">(args: Array&lt;String&gt;)</span> </span>&#123;</span><br><span class="line">    val b = BaseImpl(<span class="number">10</span>)</span><br><span class="line">    Derived(b).print() <span class="comment">// 输出 10</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/08/Kotlin深入学习系列(一)：基础篇/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="oubindo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding and Learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/08/Kotlin深入学习系列(一)：基础篇/" itemprop="url">Kotlin深入学习系列(一):基础篇</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-08T20:08:01+08:00">
                2018-04-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kotlin/" itemprop="url" rel="index">
                    <span itemprop="name">Kotlin</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="基础篇"><a href="#基础篇" class="headerlink" title="基础篇"></a>基础篇</h1><h2 id="基本类型"><a href="#基本类型" class="headerlink" title="基本类型"></a>基本类型</h2><p>1.数字<br>数字与java中基本相同，主要是下面几点不同：</p>
<ul>
<li>kotlin对于数字没有隐式扩展转换(如从int转为long)</li>
<li>在kotlin中字符不是数字</li>
</ul>
<p>2.表示方式<br>kotlin会把数字存储为jvm的原生类型，但是只有在<strong>需要可空引用或泛型时</strong>数字会被装箱。<br>但是这里存在着一个坑：当取值在[-128, 127]之间时不会被装箱，而在这之外的int数字才会被装箱，如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">val b:Int = 5    // 被编译为 short b = 5;</span><br><span class="line">val b1:Int? = b  // 被编译为 Integer i = Integer.valueOf(5)</span><br><span class="line">val b11:Int? = b  </span><br><span class="line">println(b1 === b11) // 注意这里打印的是 &apos;true&apos;  </span><br><span class="line"></span><br><span class="line">val a: Int = 10000  </span><br><span class="line">val a1: Int? = a  </span><br><span class="line">val a11: Int? = a  </span><br><span class="line">println (a1 === a11 ) //注意这里打印的是 &apos;false&apos;</span><br></pre></td></tr></table></figure></p>
<p>这是因为JVM把[-128,127]的所有int数字的装箱全部缓存了，任何指向这个范围的对象，都不可能被另外”创建”，应该是为了缓存最常用的数字以节省性能吧。</p>
<p>3.在kotlin中万物皆对象，=== 是比较对象之间的地址是否相等， == 是比较对象的大小是否相等。</p>
<p>4.数据类型转换：需要使用toByte(),toInt之类的转换。</p>
<p>5.浮点数比较有些很棒的特性：</p>
<ul>
<li>区间实例以及区间检测：a..b、 x in a..b、 x !in a..b。 这里可以使用两个点来表示，甚至比python更方便。</li>
<li>NaN与其自身相等，而且比任何其他元素都大</li>
</ul>
<p>6.字符Char不能直接当做数字，用单引号，与java一样。并且当需要可空引用时也会被装箱。</p>
<p>7.数组：数组直接用Array<t>表示<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一.已知所有元素</span></span><br><span class="line">val a = arrayOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>) <span class="comment">// array[1,2,3]</span></span><br><span class="line">val b = Array(<span class="number">5</span>, &#123; i -&gt; (i * i).toString() &#125;)  <span class="comment">// 数组大小和一个Array构造函数</span></span><br><span class="line"><span class="comment">// 二.空数组</span></span><br><span class="line">val c = emptyArray()/ arrayOfNulls&lt;String&gt;(<span class="number">0</span>)  <span class="comment">// 创建一个长度为0的null数组</span></span><br><span class="line"><span class="comment">// 三.基本类型</span></span><br><span class="line">val d = intArrayOf(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)  <span class="comment">// 对于基本类型数组有特殊优化，但是得到的IntArray并不是Array的子类。</span></span><br><span class="line"><span class="comment">// 四.创建一个已知数量的数组</span></span><br><span class="line">val a = arrayOfNulls&lt;String&gt;(<span class="number">5</span>)</span><br></pre></td></tr></table></figure></t></p>
<p>kotlin中数组是invariant的，不能把Array<string>赋值给Array<any>,但是可以是Array<out any=""></out></any></string></p>
<p>8.字符串模板<br>字符串可以包含模板表达式 ，即一些小段代码，会求值并把结果合并到字符串中。模板表达式以美元符（$）开头，由一个简单的名字构成。如果要直接输出$符，只要不加变量即可:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val s = <span class="string">"abc"</span></span><br><span class="line">println(<span class="string">"$s.length is $&#123;s.length&#125;"</span>) <span class="comment">// 输出“abc.length is 3”</span></span><br><span class="line">print(<span class="string">"$8.8"</span>)</span><br></pre></td></tr></table></figure></p>
<h2 id="控制流"><a href="#控制流" class="headerlink" title="控制流"></a>控制流</h2><p>1.if语句表达三元运算符：val max = if (a &gt; b) a else b。与python中的表达十分相似：max = a if a &gt; b else b</p>
<p>2.When表达式<br>when是一个加强的switch语句，可以作为语句也可以作为表达式。可以替代if else if链<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fun hasPrefix(x: Any) = when(x) &#123;</span><br><span class="line">    1,2 -&gt; true</span><br><span class="line">    is String -&gt; x.startsWith(&quot;prefix&quot;)</span><br><span class="line">    else -&gt; false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>3.for可以循环任何提供了迭代器的对象。</p>
<p>4.Kotlin中任何表达式都可以用标签(label)来标记。标签的格式为标识符后跟@符号<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">loop@ for (i in 1..100) &#123;</span><br><span class="line">    for (j in 1..100) &#123;</span><br><span class="line">        if (……) break@loop</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>例子中的break可以直接跳出两重循环。同样的return,continue都可以使用这种操作。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/11/生成模型与判别模型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="oubindo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding and Learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/11/生成模型与判别模型/" itemprop="url">生成模型与判别模型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-11T23:08:01+08:00">
                2018-03-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/machine-learning/" itemprop="url" rel="index">
                    <span itemprop="name">machine learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="生成模型与判别模型"><a href="#生成模型与判别模型" class="headerlink" title="生成模型与判别模型"></a>生成模型与判别模型</h2><p>1.生成模型表示了给定输入X产生输出Y的生成关系。它由数据学习联合概率分布P(X,Y),然后求出条件概率分布P(Y|X)作为预测模型，即生成模型：  </p>
<center>P(Y|X)=P(X,Y)/P(X)</center>

<p>生成模型关心的是生成关系。典型的生成模型有朴素贝叶斯法和隐式马尔科夫模型。<br>生成模型：无穷样本==》概率密度模型 = 产生模型==》预测</p>
<p>2.判别模型由数据直接学习决策函数f(X)和条件概率分布P(Y|X)作为预测的模型。它关心的是给定一个输入X，应该预测什么样的输出Y。<br>典型的判别模型有：knn，SVM，感知机等。</p>
<p>判别模型：有限样本==》判别函数 = 预测模型==》预测</p>
<p>r</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/09/TextPathView源码学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="oubindo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding and Learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/09/TextPathView源码学习/" itemprop="url">TextPathView源码学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-09T17:08:29+08:00">
                2018-03-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/源码周读/" itemprop="url" rel="index">
                    <span itemprop="name">源码周读</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="TextPathView源码学习"><a href="#TextPathView源码学习" class="headerlink" title="TextPathView源码学习"></a>TextPathView源码学习</h1><h2 id="PathMeasure"><a href="#PathMeasure" class="headerlink" title="PathMeasure"></a>PathMeasure</h2><p>PathMeasure是Path的坐标计算器，可以获取Path上每一个构成点的坐标。<br>初始化：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PathMeasure pathMeasure = <span class="keyword">new</span> PathMeasure();</span><br><span class="line">pathMeasure.setPath(path, <span class="keyword">true</span>);</span><br><span class="line"><span class="comment">// 或者使用有参构造法</span></span><br><span class="line">PathMeasure(Path path, <span class="keyword">boolean</span> forceClosed)</span><br></pre></td></tr></table></figure></p>
<p>forceClosed，简单的说，就是Path最终是否需要闭合，如果为True的话，则不管关联的Path是否是闭合的，都会被闭合。对绑定的Path没有影响，但是对PathMeasure的测量结果有影响，会包含最后一段闭合的路劲。</p>
<p>重要api：</p>
<ul>
<li>getSegment(start, stop, dst, move):将start到stop之间的path添加到dst中，可以重复添加，不会被覆盖</li>
<li>nextContour():如果有多个contour的时候，跳入到下一个contour</li>
</ul>
<h2 id="核心代码"><a href="#核心代码" class="headerlink" title="核心代码"></a>核心代码</h2><p>1.通过Paint.getTextPath获取文字path：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">initTextPath</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     mDst.reset();</span><br><span class="line">     mFontPath.reset();</span><br><span class="line">     mTextPaint.getTextPath(mText, <span class="number">0</span>, mText.length(), <span class="number">0</span>,mTextPaint.getTextSize(), mFontPath);</span><br><span class="line">     <span class="comment">// pathMeasure绑定path，就可以进行测量</span></span><br><span class="line">     mPathMeasure.setPath(mFontPath, <span class="keyword">false</span>);</span><br><span class="line">     mLengthSum = mPathMeasure.getLength();</span><br><span class="line">     <span class="comment">//获取所有路径的总长度</span></span><br><span class="line">     <span class="keyword">while</span> (mPathMeasure.nextContour()) &#123;</span><br><span class="line">         mLengthSum += mPathMeasure.getLength();</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>2.通过动画进度来控制绘制<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">mAnimator.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator valueAnimator)</span> </span>&#123;</span><br><span class="line">        mAnimatorValue = (<span class="keyword">float</span>) valueAnimator.getAnimatedValue();</span><br><span class="line">        drawPath(mAnimatorValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">startAnimation</span><span class="params">()</span></span>&#123;</span><br><span class="line">  initTextPath()  <span class="comment">// 获取到Text的path,放在mDst中</span></span><br><span class="line">  mAnimation.start()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绘制出已计算出的</span></span><br><span class="line"><span class="keyword">void</span> View.onDraw()&#123;</span><br><span class="line">  canvas.drawPath(mDst, mDrawPaint);  <span class="comment">// 这里的mDst由drawPath随时更新</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据动画进行比例计算出需要绘制的path</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawPath</span><span class="params">(<span class="keyword">float</span> progress)</span> </span>&#123;</span><br><span class="line">        mAnimatorValue = progress;</span><br><span class="line">        mStop = mLengthSum * progress;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//重置路径,目的是从开头的字开始重新测量。</span></span><br><span class="line">        mPathMeasure.setPath(mFontPath, <span class="keyword">false</span>);</span><br><span class="line">        mDst.reset();</span><br><span class="line">        mPaintPath.reset();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//根据进度获取路径</span></span><br><span class="line">        <span class="keyword">while</span> (mStop &gt; mPathMeasure.getLength()) &#123;</span><br><span class="line">            mStop = mStop - mPathMeasure.getLength();</span><br><span class="line">            mPathMeasure.getSegment(<span class="number">0</span>, mPathMeasure.getLength(), mDst, <span class="keyword">true</span>); <span class="comment">// 这里计算出来的Path会和后面的0-stop的path相加</span></span><br><span class="line">            <span class="keyword">if</span> (!mPathMeasure.nextContour()) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        mPathMeasure.getSegment(<span class="number">0</span>, mStop, mDst, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//绘画画笔效果</span></span><br><span class="line">        <span class="keyword">if</span> (showPainterActually) &#123;</span><br><span class="line">            mPathMeasure.getPosTan(mStop, mCurPos, <span class="keyword">null</span>);</span><br><span class="line">            drawPaintPath(mCurPos[<span class="number">0</span>], mCurPos[<span class="number">1</span>], mPaintPath);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//绘画路径</span></span><br><span class="line">        postInvalidate();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从上面可以看到，只要我们修改一下，把while循环的起点改为每一个contour，分别绘制对应的比例就行。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (mPathMeasure.nextContour()) &#123;</span><br><span class="line">    mLength = mPathMeasure.getLength();</span><br><span class="line">    mStop = mLength * mAnimatorValue;</span><br><span class="line">    mPathMeasure.getSegment(<span class="number">0</span>, mStop, mDst, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//绘画画笔效果</span></span><br><span class="line">    <span class="keyword">if</span> (showPainterActually) &#123;</span><br><span class="line">        mPathMeasure.getPosTan(mStop, mCurPos, <span class="keyword">null</span>);</span><br><span class="line">        drawPaintPath(mCurPos[<span class="number">0</span>],mCurPos[<span class="number">1</span>],mPaintPath);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="启示"><a href="#启示" class="headerlink" title="启示"></a>启示</h2><p>onDraw里面是不能进行耗时操作的，所以在动画进行的回调函数中去进行progress的判断，然后更新onDraw里面要用到的数值。</p>
<p>。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/07/开发模式进阶/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="oubindo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding and Learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/07/开发模式进阶/" itemprop="url">开发模式进阶</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-07T18:15:37+08:00">
                2018-03-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android进阶/" itemprop="url" rel="index">
                    <span itemprop="name">Android进阶</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="常见的开发模式"><a href="#常见的开发模式" class="headerlink" title="常见的开发模式"></a>常见的开发模式</h1><h2 id="MVP"><a href="#MVP" class="headerlink" title="MVP"></a>MVP</h2><p>MVP也就是model-view-presenter模式。由presenter来连接model和view之间的联系，并且进行view里面的逻辑操作。好处是使得view更加简洁，逻辑清楚易于维护。</p>
<p>缺点是</p>
<ul>
<li>大量引入类，开发者可能不能辨别三层的具体分工导致无法解耦。</li>
<li>MVP以UI和事件为驱动，数据被动的通过UI来展示，但是数据的时变性，我们希望数据能转被动为主动，由数据来推动UI。</li>
<li>一旦V层某个UI元素更改，那么对应的接口和事件监听都得改。</li>
</ul>
<p>下面分析google的mvp项目</p>
<h3 id="todo-mvp"><a href="#todo-mvp" class="headerlink" title="todo-mvp"></a>todo-mvp</h3><p>google Mvp架构</p>
<p><img src="http://ovkwd4vse.bkt.clouddn.com/markdown-img-paste-20180307191551416.png" alt=""></p>
<p>技术亮点：<br>1.xml属性：parentActivityName:指定activity的父activity，系统会读取该属性，以确定当用户按下操作栏中的“向上”按钮时应该启动哪一个 Activity。 系统还可以利用这些信息通过 TaskStackBuilder 合成 Activity 的返回栈。</p>
<p>2.xml属性：noHistory:当用户离开 Activity 并且其在屏幕上不再可见时，是否应从 Activity 堆栈中将其移除并完成。当为true时onActivityResult无法取得数据。</p>
<h2 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h2><p>参考<a href="https://tech.meituan.com/android_mvvm.html" target="_blank" rel="noopener">如何构建Android MVVM应用框架</a><br>具体角色与MVP相似，Presenter由ViewModel替换，Model的角色扩展了，添加了进行数据的获取，存储，数据状态变化的任务。MVVM的目标和思想与MVP类似，利用数据绑定(Data Binding)、依赖属性(Dependency Property)、命令(Command)、路由事件(Routed Event)等新特性，打造了一个更加灵活高效的架构。</p>
<p>数据驱动<br>在常规的开发模式中，数据变化需要更新UI的时候，需要先获取UI控件的引用，然后再更新UI。获取用户的输入和操作也需要通过UI控件的引用。在MVVM中，这些都是通过数据驱动来自动完成的，数据变化后会自动更新UI，UI的改变也能自动反馈到数据层，数据成为主导因素。这样MVVM层在业务逻辑处理中只要关心数据，不需要直接和UI打交道</p>
<p>低耦合度<br>MVVM模式中，数据是独立于UI的。数据和业务逻辑处于一个独立的ViewModel中，ViewModel只需要关注数据和业务逻辑，不需要和UI或者控件打交道。UI想怎么处理数据都由UI自己决定，ViewModel不涉及任何和UI相关的事，也不持有UI控件的引用。即便是控件改变了（比如：TextView换成EditText），ViewModel也几乎不需要更改任何代码。它非常完美的解耦了View层和ViewModel，解决了上面我们所说的MVP的痛点。</p>
<p>更新UI<br>在MVVM中，数据发生变化后，我们在工作线程直接修改（在数据是线程安全的情况下）ViewModel的数据即可，不用再考虑要切到主线程更新UI了，这些事情相关框架都帮我们做了。</p>
<p>可复用性<br>一个ViewModel可以复用到多个View中。同样的一份数据，可以提供给不同的UI去做展示。对于版本迭代中频繁的UI改动，更新或新增一套View即可。如果想在UI上做A/B Testing，那MVVM是你不二选择。</p>
<p>架构：<br><img src="http://ovkwd4vse.bkt.clouddn.com/markdown-img-paste-20180307203951504.png" alt=""></p>
<p><strong>ViewModel与View协作</strong><br>ViewModel和View是通过绑定的方式连接在一起的，绑定分成两种：一种是数据绑定，一种是命令绑定。数据的绑定DataBinding已经提供好了，简单地定义一些ObservableField就能把数据和控件绑定在一起了。我们看ViewModel的结构：</p>
<ul>
<li>Context：用于网络判断生命周期，防止请求回来时Activity已经销毁及工具类等</li>
<li>Model：其实就是Java Bean，可以用来生成对应的ObservableField。这是肯定需要持有的。</li>
<li>Data Field(数据绑定)：需要绑定到控件上的ObservableField字段。</li>
<li>Command(命令绑定)：对事件的处理，比如下拉，加载，点击等。存在的问题是如果不使用三方库可能需要持有View的引用，等会需要特别注意一下这里。使用DataBinding就可以在xml中绑定View的处理命令</li>
<li>Child ViewModel：子vm，比如一个Activity由两个Fragment，这样就可以有两个子vm</li>
</ul>
<p><strong>ViewModel与Model协作</strong><br>ViewModel通过传参数到Model层获取网络数据（数据库同理），然后把Model的部分数据映射到ViewModel的一些字段（ObservableField），并在ViewModel保留这个Model的引用</p>
<p><strong>ViewModel与ViewModel的协作</strong><br>用Messenger来在ViewModel中进行通讯。</p>
<h2 id="Clean-Architecture"><a href="#Clean-Architecture" class="headerlink" title="Clean-Architecture"></a>Clean-Architecture</h2><p>基本思想：<br><img src="http://ovkwd4vse.bkt.clouddn.com/markdown-img-paste-20180307193527676.png" alt=""></p>
<p>项目架构：<br><img src="http://ovkwd4vse.bkt.clouddn.com/markdown-img-paste-2018030720122662.png" alt=""></p>
<p>Presenter层可以使用MVP或MVVM模式，Data Layer负责获取数据，不管是数据库还是磁盘，网络都是用这层来处理。Domain layer负责处理使用场景，也就是负责处理逻辑。相当于Presenter层的Presenter需要依赖Domain layer才能真正处理逻辑。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/02/源码周读计划开门篇/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="oubindo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding and Learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/02/源码周读计划开门篇/" itemprop="url">源码周读计划开门篇</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-02T23:08:01+08:00">
                2018-03-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/源码周读/" itemprop="url" rel="index">
                    <span itemprop="name">源码周读</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="源码周读计划"><a href="#源码周读计划" class="headerlink" title="源码周读计划"></a>源码周读计划</h2><p>优秀的源码可以启发一生。现在自己正好在学校，想给自己增加一些代码广度和阅历，希望自己能通过不同领域的源码进而去学习相关知识来健全自己的知识体系结构。</p>
<p>源码的内容在近期里以Android库为主，包括GitHub上的Android基础库和Android APP。一周读一个APP，读懂它的系统架构，设计思想及优秀的技术点。后期可以往各个方向涉猎，暂时不做限制。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">oubindo</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">oubindo</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
